연습) 극장별 상영관 수
```
select 극장이름, count(*) from 극장, 상영관
where 극장.극장번호 = 상영관.극장번호 
group by 극장이름 ;
```
```
극장이름     COUNT(*)
---------- ----------
CGV                 2
독립                2
롯데                1
대한                2
```
연습) 잠실에 있는 극장의 상영관
`select * from 상영관 where 극장번호 in (select 극장번호 from 극장 where 위치 = '잠실');`
```
극장번호 상영관번호 영화제목            가격     좌석수
-------- ---------- --------------- -------- ----------
       1          1 어려운 영화       15,000         48
       3          1 멋진 영화          7,500        120
       3          2 재밌는 영화        8,000        110
```
연습) 2014년 9월 1일의 극장별 평균 관람 고객 수
2014년 9월 1일 날짜에 '대한'극장에서 상영하는 영화가 A,B,C 상영된다고 가정
A 10
B 10
C 10
만약 '대한'극장에서 상영하는 영화의 수가 3개이고 각 영화별 관람고객수가 위와 같다면
이 극장의 9월 1일날 평균관람고객수는 10이 됌 
1) 2014년 9월 1일 날짜에 대한극장에서 상영하는 상영관의 수 cnt
```
A
select count(distinct 상영관.상영관번호) cnt from 극장, 상영관, 예약
where 극장.극장번호 = 상영관.극장번호 and
상영관.극장번호 = 예약.극장번호 and
상영관.상영관번호 = 예약.상영관번호 and
날짜 = '2014/09/01' and
극장이름 = '대한';
```
```
COUNT(DISTINCT상영관.상영관번호)
--------------------------------
                               2
```

2) 2014년 9월 1일 날짜에 대한극장의 총 관람수 sum

```
B
select count(*) sum from 극장, 상영관, 예약
where 극장.극장번호 = 상영관.극장번호 and
상영관.극장번호 = 예약.극장번호 and
상영관.상영관번호 = 예약.상영관번호 and
날짜 = '2014/09/01' and
극장이름 = '대한';
```
```
  SUM
----------
      5
```

3) 2014년 9월 1일 대한극장의 평균 관람 고객수 sum/cnt
```
select count(*) / count(distinct 상영관.상영관번호) from 극장, 상영관, 예약
where 극장.극장번호 = 상영관.극장번호 and
상영관.극장번호 = 예약.극장번호 and
상영관.상영관번호 = 예약.상영관번호 and
날짜 = '2014/09/01' and
극장이름 = '대한';
```

연습) 2014년 9월 1일에 가장 많은 고객이 관람한 영화
1)2014년 9월 1일 날짜에 영화별로 관람수 출력
```
select 영화제목, count(*)
from 극장, 상영관, 예약
where 극장.극장번호 = 상영관.극장번호 and
상영관.극장번호 = 예약.극장번호 and
상영관.상영관번호 = 예약.상영관번호 and
날짜 = '2014/09/01'
group by 영화제목;
```
```
영화제목          COUNT(*)
--------------- ----------
어려운 영화              1
멋진 영화                1
재밌는 영화              4
```
2)2014년 9월 1일 날짜에 영화별 관람수의 최댓값
```
select max(count(*))
from 극장, 상영관, 예약
where 극장.극장번호 = 상영관.극장번호 and
상영관.극장번호 = 예약.극장번호 and
상영관.상영관번호 = 예약.상영관번호 and
날짜 = '2014/09/01'
group by 영화제목;
```
```
MAX(COUNT(*))
-------------
            4
```
3) 가장 많은 고객이 관람한 영화
```
select 영화제목, count(*)
from 극장, 상영관, 예약
where 극장.극장번호 = 상영관.극장번호 and
상영관.극장번호 = 예약.극장번호 and
상영관.상영관번호 = 예약.상영관번호 and
날짜 = '2014/09/01'
group by 영화제목;
having count(*) = (select max(count(*))
from 극장, 상영관, 예약
where 극장.극장번호 = 상영관.극장번호 and
상영관.극장번호 = 예약.극장번호 and
상영관.상영관번호 = 예약.상영관번호 and
날짜 = '2014/09/01'
group by 영화제목);
```
```
영화제목          COUNT(*)
--------------- ----------
재밌는 영화              4
```

연습) 각 테이블에 데이터를 삽입하는 insert문 실행
```
insert into 극장 values(4,'CGV','일산');
insert into 상영관 values(4,3,'슬픈 영화',10000,130);
insert into 상영관 values(4,4,'노잼 영화',5000,160);
insert into 고객 values(1,'김유신','일산');
insert into 고객 values(10,'박성미','강남');
insert into 예약 values(4,4,6,20,'2021/11/15');
insert into 예약 values(4,4,10,30,sysdate);
```

연습) '박성미' 고객이 오늘 날짜에 예약한 영화제목, 극장이름, 좌석번호를 출력

```
select 영화제목, 극장이름, 좌석번호 from 극장, 상영관, 예약,고객
where 극장.극장번호 = 상영관.극장번호 and
상영관.극장번호 = 예약.극장번호 and
상영관.상영관번호 = 예약.상영관번호 and
예약.고객번호 = 고객.고객번호 and
이름 = '박성미' 
```
```
영화제목        극장이름   좌석번호
--------------- ---------- --------
노잼 영화       CGV              30
재밌는 영화     대한              1
```

실험) 오늘 날짜 검색

```
select 영화제목, 극장이름, 좌석번호 from 극장, 상영관, 예약,고객
where 극장.극장번호 = 상영관.극장번호 and
상영관.극장번호 = 예약.극장번호 and
상영관.상영관번호 = 예약.상영관번호 and
예약.고객번호 = 고객.고객번호 and
이름 = '박성미' and
날짜 = '2021/11/16';
```
```
영화제목        극장이름   좌석번호
--------------- ---------- --------
노잼 영화       CGV              30
```

**sysdate으로 insert한 레코드는 출력되지 않음**

sysdate에는 날짜뿐만아니라 시,분,초에 대한 정보도 가지고 있음

시,분,초가 달라서 검색이 되지 않음!!!

to_char(날짜,'yyyy/mm/dd') 형식지정 문자 사용해야함

```
select 영화제목, 극장이름, 좌석번호 from 극장, 상영관, 예약,고객
where 극장.극장번호 = 상영관.극장번호 and
상영관.극장번호 = 예약.극장번호 and
상영관.상영관번호 = 예약.상영관번호 and
예약.고객번호 = 고객.고객번호 and
이름 = '박성미' and
to_char(날짜,'yyyy/mm/dd') = '2021/11/16';
```

연습) 영화의 가격을 10%씩 인상
```
극장번호 상영관번호 영화제목            가격     좌석수
-------- ---------- --------------- -------- ----------
       4          3 슬픈 영화         10,000        130
       4          4 노잼 영화          5,000        160
       5          1 공포 영화          7,000         50
       5          2 보통 영화          8,000         80
       1          1 어려운 영화       15,000         48
       3          1 멋진 영화          7,500        120
       3          2 재밌는 영화        8,000        110
```

`update 상영관 set 가격 = 가격*1.1`
```
극장번호 상영관번호 영화제목            가격     좌석수
-------- ---------- --------------- -------- ----------
       4          3 슬픈 영화         11,000        130
       4          4 노잼 영화          5,500        160
       5          1 공포 영화          7,700         50
       5          2 보통 영화          8,800         80
       1          1 어려운 영화       16,500         48
       3          1 멋진 영화          8,250        120
       3          2 재밌는 영화        8,800        110
```








